/**
 * visualCaptchaHTML class by emotionLoop - 2013.03.28
 *
 * This class handles the JS for the main visualCaptcha class.
 *
 * This license applies to this file and others without reference to any other license.
 *
 * @author emotionLoop | http://emotionloop.com
 * @link http://visualcaptcha.net
 * @package visualCaptcha
 * @license GNU GPL v3 | http://www.gnu.org/licenses/gpl.html
 * @version 4.0.3
 */
(function(e){var t=false;var n=false;var r=false;var i=navigator.userAgent.toLowerCase();if(i.indexOf("iphone")!==-1||i.indexOf("ipad")!==-1||i.indexOf("ipod")!==-1||i.indexOf("android")!==-1||i.indexOf("windows phone")!==-1||i.indexOf("windows ce")!==-1||i.indexOf("bada")!==-1||i.indexOf("meego")!==-1||i.indexOf("palm")!==-1||i.indexOf("blackberry")!==-1||i.indexOf("nokia")!==-1||i.indexOf("symbian")!==-1||i.indexOf("pocketpc")!==-1||i.indexOf("smartphone")!==-1||i.indexOf("mobile")!==-1){t=true}if(window.devicePixelRatio&&window.devicePixelRatio>1){n=true}try{var s=document.createElement("audio");if(s.canPlayType){r=true}}catch(o){}if(n){e("div.eL-captcha img").each(function(t,n){if(!e(n).attr("src"))return;var r=e(n).attr("src").replace(/(.+)(\.\w{3,4})$/,"$1@2x$2");e.ajax({url:r,type:"HEAD",success:function(){e(n).attr("src",r)}})});e("div.eL-captcha > div.eL-where2go").addClass("retina")}if(!r){e("div.eL-captcha > .eL-accessibility").hide()}else{e("div.eL-captcha > p.eL-accessibility a").on("click touchstart",function(t){t.preventDefault();if(!e("div.eL-captcha > div.eL-accessibility").is(":visible")){e("div.eL-captcha > div.eL-accessibility > audio").each(function(){this.load();this.play()});if(!e("#"+window.vCVals.a).length){var n='<input type="text" name="'+window.vCVals.a+'" id="'+window.vCVals.a+'" value="">';e("div.eL-captcha > div.eL-accessibility > p").after(n)}}e("div.eL-captcha > p.eL-explanation").stop().slideToggle("fast");e("div.eL-captcha > div.eL-possibilities").stop().slideToggle("fast");e("div.eL-captcha > div.eL-where2go").stop().slideToggle("fast");e("div.eL-captcha > div.eL-accessibility").stop().slideToggle("fast")})}if(!t){e("div.eL-captcha > div.eL-possibilities > img").draggable({opacity:.6,revert:"invalid"});e("div.eL-captcha > div.eL-possibilities").droppable({drop:function(t,n){if(!e("#"+window.vCVals.n).length){return false}if(e("#"+window.vCVals.n).val()==e(n.draggable).data("value")){e("#"+window.vCVals.n).remove()}e("div.eL-captcha > div.eL-where2go").droppable("enable")},accept:"div.eL-captcha > div.eL-possibilities > img"});e("div.eL-captcha > div.eL-where2go").droppable({drop:function(t,n){if(e("#"+window.vCVals.n).length){return false}var r='<input type="hidden" name="'+window.vCVals.n+'" id="'+window.vCVals.n+'" readonly="readonly" value="'+e(n.draggable).data("value")+'">';e("#"+window.vCVals.f).append(r);e(this).droppable("disable")},accept:"div.eL-captcha > div.eL-possibilities > img"})}else{e("div.eL-captcha > div.eL-possibilities > img").on("click touchstart",function(){var t=e("div.eL-captcha > div.eL-where2go").offset().left-5;var n=e("div.eL-captcha > div.eL-where2go").offset().top;var r=e("div.eL-captcha > div.eL-where2go").width();var i=e("div.eL-captcha > div.eL-where2go").height();var s=e(this).width();var o=e(this).height();if(e(this).css("position")=="absolute"){if(!e("#"+window.vCVals.n).length){return false}if(e("#"+window.vCVals.n).val()==e(this).data("value")){e("#"+window.vCVals.n).remove()}e(this).css({position:"relative",left:"auto",top:"auto"})}else{if(e("#"+window.vCVals.n).length){return false}var u='<input type="hidden" name="'+window.vCVals.n+'" id="'+window.vCVals.n+'" readonly="readonly" value="'+e(this).data("value")+'">';e("#"+window.vCVals.f).append(u);var a=Math.round(t+r/2-s/2);var f=Math.round(n+i/2-o/2);e(this).css({position:"absolute",left:a,top:f})}})}})(jQuery)
